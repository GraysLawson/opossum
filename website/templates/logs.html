{% extends 'base.html' %}

{% block content %}
<h2>Bot Logs</h2>
{% if error %}
    <p class="error">{{ error }}</p>
{% endif %}
<div id="log-container" class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow-inner h-96 overflow-y-auto">
    <pre id="log-content" class="text-sm text-gray-900 dark:text-gray-100 font-mono"></pre>
</div>

<script>
    const logContainer = document.getElementById('log-container');
    const logContent = document.getElementById('log-content');

    const eventSource = new EventSource("{{ url_for('logs.stream_logs') }}");

    eventSource.onmessage = function(event) {
        const log = JSON.parse(event.data);
        const logEntry = `${log.timestamp} - ${log.level} - ${log.message}\n`;
        logContent.textContent += logEntry;
        logContainer.scrollTop = logContainer.scrollHeight;
    };

    eventSource.onerror = function(error) {
        console.error("EventSource failed:", error);
        eventSource.close();
    };
</script>
{% endblock %}
